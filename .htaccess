<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    
    # SECURITY: Force 403 Forbidden for wp-config.php (MUST BE BEFORE WP RULES)
    RewriteRule ^wp-config\.php$ - [F,L]
    
    # SECURITY: Block PHP execution in /wp-content/uploads/
    RewriteRule ^wp-content/uploads/.*\.php$ - [F,L]
</IfModule>

# SECURITY: Extra layer using <Files> to ensure 403 Forbidden
<Files wp-config.php>
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</Files>

# SECURITY: Disable directory listing
Options -Indexes

# SECURITY: Protect .htaccess itself
<Files .htaccess>
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</Files>

# BEGIN WordPress
# The directives (lines) between "BEGIN WordPress" and "END WordPress" are
# dynamically generated, and should only be modified via WordPress filters.
# Any changes to the directives between these markers will be overwritten.
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress
